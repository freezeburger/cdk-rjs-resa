# Guide : Créer et Consommer un CDK en Monorepo (formation avancée simplifiée)

Ce document vise à montrer comment construire un **Component Design Kit (CDK)**
dans un monorepo et le rendre utilisable par des équipes ayant peu de connaissance en React.

---

## 🎯 Objectif
- Fournir un **kit de design (CDK)** simple à consommer : primitives, composants stylés, thèmes, icônes.
- Masquer la complexité (tokens, state, accessibilité) derrière des **APIs stables et prévisibles**.
- Guider les équipes via **générateurs**, **docs vivantes**, **exemples copiables**, et **règles outillées**.

---

## 🧭 Golden Path
1. **Tokens → Thème → Primitives → Composants**
   - Les équipes consomment surtout `@cdk/components`.
   - Tokens/Thème/Headless restent invisibles pour les débutants.

2. **API simple et stable**
   - Props communes : `className?`, `style?`, `disabled?`, `size?`, `variant?`.
   - Valeurs par défaut sensées, noms cohérents.

3. **Docs vivantes (Storybook)**
   - Exemple minimal + exemple réaliste (copier-coller).
   - Controls pour jouer.
   - Section “bonnes pratiques” ultra-courte.

4. **Générateurs Plop obligatoires**
   - Création guidée : composants, hooks, services, tokens, icônes…
   - Génération de la story + test + append export automatique.

5. **Règles d’imports et garde-fous**
   - ESLint : interdits d’import croisés (`components` → `tokens`).
   - Interdiction des couleurs brutes (`#fff`) : obligation d’utiliser un token.
   - Interdiction de CSS ad-hoc si un composant CDK existe.

---

## 🗂️ Architecture accessible

- `@cdk/tokens` : JSON + TS (rarement modifié par les équipes).  
- `@cdk/theme` : expose `ThemeProvider` + CSS vars.  
- `@cdk/primitives` : atoms (`Box`, `Stack`, `Text`, `Icon`, `Portal`).  
- `@cdk/headless` : logique sans UI (hooks/services).  
- `@cdk/components` : **API principale** pour les équipes.  
- `@cdk/icons` : set minimal d’icônes.  
- `@cdk/presets` : thèmes prêts à l’emploi.  
- `@cdk/lab` : zone d’expérimentation (RichText, Charts…).  

> Pour les utilisateurs finaux : importer uniquement depuis `@cdk/components`.  
> Pour les mainteneurs CDK : couches bas-niveau disponibles pour l’évolution.

---

## 🧰 Expérience Dev (DX)
- **Storybook** comme page d’accueil du CDK.  
- **Snippets VSCode** (`cdk-btn`, `cdk-card`, …).  
- **Plop** comme générateur central.  
- **Prettier/ESLint** pour normaliser.  
- **Tests minimaux** : snapshot tokens, smoke tests composants.

---

## 🧪 Tests
- **Headless** : unitaires (logique pure).  
- **Components** : rendu minimal + accessibilité (axe).  
- **Tokens/Thème** : snapshots JSON / mapping CSS vars.

---

## 👩‍🏫 Formation (3 modules)
### M1 — Consommer le CDK
- Notions “juste ce qu’il faut” (tokens → theme → components).  
- Découverte Storybook.  
- Exercice : écran simple avec 3 composants (Button, Card, Stack).

### M2 — Étendre
- Ajouter un **token** via `plop cdk`.  
- Créer une **icône**.  
- Créer un **composant léger** avec `import * as Primitives`.

### M3 — Mainteneurs (avancé)
- Ajouter une **primitive** + mapping thème.  
- Créer un **hook/service headless** et l’habiller en composant.  
- Garde-fous ESLint (tokens only, imports interdits).

---

## ✅ Critères de succès
- 90% des équipes utilisent **uniquement `@cdk/components`**.  
- < 15 min pour créer un écran standard.  
- < 5 min pour ajouter un token.  
- 0 “couleur brute” (hex/rgb) détectée par l’ESLint rule `use-token`.

---

## 📎 Prochaines étapes
1. Activer **Storybook** dans `@cdk/components` et y ajouter 5 composants de base (Button, Card, Input, Stack, Text).  
2. Brancher `ThemeProvider` dans chaque app.  
3. Rendre obligatoires les **générateurs Plop** (doc + CI).  
4. Ajouter **3 règles ESLint** :  
   - pas de couleur brute,  
   - imports cloisonnés,  
   - export uniquement via `index.ts`.  
5. Ajouter une page “**Démarrer en 10 minutes**” (doc + exemples copiables).

---
